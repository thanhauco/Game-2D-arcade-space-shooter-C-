# Stellar Fury - Architecture Overview

## System Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                          MAIN LOOP                               │
│                         (main.cpp)                               │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         GAME CLASS                               │
│                         (Game.h/cpp)                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │ Game State  │  │   Input     │  │    Entity Management   │  │
│  │  Machine    │  │  Handler    │  │                         │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└─────────────────────────────┬───────────────────────────────────┘
                              │
        ┌─────────────────────┼─────────────────────┐
        │                     │                     │
        ▼                     ▼                     ▼
┌───────────────┐    ┌───────────────┐    ┌───────────────┐
│   ENTITIES    │    │    SYSTEMS    │    │      UI       │
│               │    │               │    │               │
│  ┌─────────┐  │    │  ┌─────────┐  │    │  ┌─────────┐  │
│  │ Player  │  │    │  │Starfield│  │    │  │   HUD   │  │
│  └─────────┘  │    │  └─────────┘  │    │  └─────────┘  │
│  ┌─────────┐  │    │  ┌─────────┐  │    │               │
│  │ Enemy   │  │    │  │Particle │  │    │               │
│  │ (3 types)  │    │  │ System  │  │    │               │
│  └─────────┘  │    │  └─────────┘  │    │               │
│  ┌─────────┐  │    │               │    │               │
│  │ Bullet  │  │    │               │    │               │
│  └─────────┘  │    │               │    │               │
└───────────────┘    └───────────────┘    └───────────────┘
```

## Class Hierarchy

```
                    ┌──────────────┐
                    │    Entity    │
                    │   (Base)     │
                    └──────┬───────┘
                           │
         ┌─────────────────┼─────────────────┐
         │                 │                 │
         ▼                 ▼                 ▼
   ┌──────────┐     ┌──────────┐     ┌──────────┐
   │  Player  │     │  Enemy   │     │  Bullet  │
   └──────────┘     └──────────┘     └──────────┘
                           │
         ┌─────────────────┼─────────────────┐
         │                 │                 │
         ▼                 ▼                 ▼
   ┌──────────┐     ┌──────────┐     ┌──────────┐
   │ Drifter  │     │  Hunter  │     │  Bomber  │
   └──────────┘     └──────────┘     └──────────┘
```

## Game State Machine

```
                    ┌──────────┐
                    │   Menu   │◄──────────────────┐
                    └────┬─────┘                   │
                         │ [ENTER]                 │
                         ▼                         │
                    ┌──────────┐                   │
              ┌─────│ Playing  │◄────┐             │
              │     └────┬─────┘     │             │
              │          │           │             │
        [ESC] │    [Health <= 0]     │ [ESC]       │
              │          │           │             │
              ▼          ▼           │             │
        ┌──────────┐ ┌──────────┐    │             │
        │  Paused  │ │ GameOver │────┘             │
        └────┬─────┘ └────┬─────┘   [ENTER]        │
             │            │                        │
             └────────────┴────────────────────────┘
```

## Data Flow

```
┌─────────────┐     ┌──────────────┐     ┌─────────────┐
│   Input     │────▶│    Update    │────▶│   Render    │
│  (Keyboard) │     │   (Logic)    │     │  (Draw)     │
└─────────────┘     └──────────────┘     └─────────────┘
                           │
         ┌─────────────────┼─────────────────┐
         │                 │                 │
         ▼                 ▼                 ▼
   ┌──────────┐     ┌──────────┐     ┌──────────┐
   │ Movement │     │ Collision│     │ Spawning │
   │ Physics  │     │ Detection│     │  Logic   │
   └──────────┘     └──────────┘     └──────────┘
```

## Collision Detection

```
┌─────────────────────────────────────────────────────┐
│              Collision Matrix                        │
├─────────────────┬─────────────────────────────────┬─┤
│                 │ Player  Enemy  P.Bullet E.Bullet│ │
├─────────────────┼─────────────────────────────────┼─┤
│ Player          │   -       ✓       -        ✓    │ │
│ Enemy           │   ✓       -       ✓        -    │ │
│ Player Bullet   │   -       ✓       -        -    │ │
│ Enemy Bullet    │   ✓       -       -        -    │ │
└─────────────────┴─────────────────────────────────┴─┘
```

## Memory Management

- All entities use `std::unique_ptr` for automatic memory management
- Entity pools managed by Game class vectors
- Inactive entities cleaned up each frame using `std::remove_if`

## Performance Considerations

| Component  | Target         | Strategy                 |
| ---------- | -------------- | ------------------------ |
| Frame Rate | 60 FPS         | VSync enabled            |
| Delta Time | Capped at 50ms | Prevents spiral of death |
| Particles  | ~100 max       | Pool recycling           |
| Enemies    | ~20 max        | Progressive spawn        |
